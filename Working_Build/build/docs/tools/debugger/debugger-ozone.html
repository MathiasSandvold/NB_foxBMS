<!-- https://stackoverflow.com/a/53329712 -->

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.2.1. Segger Ozone Debugger &mdash; foxBMS 2 1.5.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme_overrides.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.2.3. Lauterbach Trace32 Debugger" href="debugger-lauterbach.html" />
    <link rel="prev" title="4. Debugging the Application" href="debug-application.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> foxBMS 2
            <img src="../../_static/foxbms250px.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.5.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general/releases.html">1. Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/changelog.html">2. Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/motivation.html">3. Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/safety/safety.html">4. Safety</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/license.html">5. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/team.html">6. Team</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/abbreviations-definitions.html">1. Abbreviations and Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/naming-conventions.html">2. Naming Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/bms-overview.html">3. The foxBMS 2 Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/use-case.html">4. Use Case</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/getting-started.html">1. Getting Started with foxBMS 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/repository-structure.html">2. Repository Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/software-installation.html">3. Software Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/workspace.html">4. Creating a Workspace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/first-steps-on-hardware.html">5. First Steps on Hardware</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../software/configuration/configuration.html">1. Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/build/build.html">2. Building the Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/overview/sw-overview.html">3. Software Structure Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/modules/modules.html">4. Software Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/unit-tests/unit-tests.html">5. Unit Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/build-process/build-process.html">6. Build Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/build-environment/build-environment.html">7. Build Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/how-to/how-to.html">8. How-to</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/linker-script/linker-script.html">9. Linker Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/architecture/architecture.html">10. Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/api/overview.html">11. API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/hardware.html">1. Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/design-resources.html">2. Design Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/connectors.html">3. Connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/master.html">4. Master Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/slaves.html">5. Slaves Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/interfaces.html">6. Interfaces Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">System Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../system/system-introduction.html">1. System Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../system/system-voltage-and-current-monitoring.html">2. System Voltage And Current Monitoring</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dbc.html">1. DBC File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/gui.html">2. foxBMS 2 GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../waf-tools/waf-tools.html">3. Waf Tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="debug-application.html">4. Debugging the Application</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.2.1. Segger Ozone Debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="#j-flash">4.2.2. J-Flash</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugger-lauterbach.html">4.2.3. Lauterbach Trace32 Debugger</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../halcogen/halcogen.html">5. HALCoGen tool documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../static-analysis/axivion.html">6. Axivion Bauhaus Suite</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../developer-manual/preface.html">1. Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-manual/style-guide/style-guide.html">2. Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-manual/software-developer-manual.html">3. Software Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-manual/hardware-developer-manual.html">4. Hardware Developer Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer-manual/public-release-process.html">5. Public Release Process</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/acknowledgements.html">1. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/indices-and-tables.html">2. Indices and Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/bibliography.html">3. Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">foxBMS 2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="debug-application.html"><span class="section-number">4. </span>Debugging the Application</a> &raquo;</li>
      <li><span class="section-number">4.2.1. </span>Segger Ozone Debugger</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tools/debugger/debugger-ozone.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
             
  <div class="section" id="segger-ozone-debugger">
<span id="id1"></span><h1><span class="section-number">4.2.1. </span>Segger Ozone Debugger<a class="headerlink" href="#segger-ozone-debugger" title="Permalink to this headline"></a></h1>
<div class="section" id="required-hardware">
<h2><span class="section-number">4.2.1.1. </span>Required Hardware<a class="headerlink" href="#required-hardware" title="Permalink to this headline"></a></h2>
<p>For debugging the foxBMS 2 application with the Segger tools the
following hardware is required:</p>
<ul class="simple">
<li><p>J-Link PLUS</p></li>
<li><p>J-Link Mictor 38 Adapter</p></li>
</ul>
</div>
<div class="section" id="debugger-software">
<h2><span class="section-number">4.2.1.2. </span>Debugger Software<a class="headerlink" href="#debugger-software" title="Permalink to this headline"></a></h2>
<p>The debugger software is available at
<a class="reference external" href="https://www.segger.com/products/development-tools/ozone-j-link-debugger/">https://www.segger.com</a>.</p>
</div>
<div class="section" id="segger-ozone-manual">
<h2><span class="section-number">4.2.1.3. </span>Segger Ozone Manual<a class="headerlink" href="#segger-ozone-manual" title="Permalink to this headline"></a></h2>
<p>Refer to the
<a class="reference external" href="https://www.segger.com/downloads/jlink/UM08025">Ozone manual</a>
for working with the Segger debugger and tools.</p>
</div>
<div class="section" id="setup">
<h2><span class="section-number">4.2.1.4. </span>Setup<a class="headerlink" href="#setup" title="Permalink to this headline"></a></h2>
<p>After setting up the hardware connection you should be able to load the
Ozone configuration.
For details on where to find a ready configuration for foxBMS 2, please refer
to <a class="reference internal" href="../waf-tools/f_ozone.html#waf-tool-ozone"><span class="std std-numref">Section 3.1.11</span></a>.</p>
</div>
<div class="section" id="common-pitfalls">
<h2><span class="section-number">4.2.1.5. </span>Common Pitfalls<a class="headerlink" href="#common-pitfalls" title="Permalink to this headline"></a></h2>
<p>When creating too many cyclically updated entries in the watch window, the
debugger seems to stop and read the target so often that it impacts the system
performance.
Being aware of this issue and keeping an eye on the number of automatically
updated variable watches should mitigate this issue.</p>
</div>
<div class="section" id="lookup-program-location-of-assertion">
<h2><span class="section-number">4.2.1.6. </span>Lookup Program location of assertion<a class="headerlink" href="#lookup-program-location-of-assertion" title="Permalink to this headline"></a></h2>
<p>In the case that the program has asserted, the location of the assertion will
be written to <code class="docutils literal notranslate"><span class="pre">fas_assertLocation.pc</span></code> as mentioned in
<a class="reference internal" href="debug-application.html#debugging-the-application"><span class="std std-ref">Debugging the Application</span></a>.</p>
<p>With Ozone, the location of this assertion in the program code can be looked up
as follows:</p>
<ul class="simple">
<li><p>The variable <code class="docutils literal notranslate"><span class="pre">fas_assertLocation</span></code> has to be viewable in <code class="docutils literal notranslate"><span class="pre">Global</span> <span class="pre">Data</span></code> or
in <code class="docutils literal notranslate"><span class="pre">Watched</span> <span class="pre">Data</span></code>.</p></li>
<li><p>It has to be updated (ideally by pausing program execution).</p></li>
<li><p>Unfold <code class="docutils literal notranslate"><span class="pre">fas_assertLocation</span></code> so that the members are shown.
Do not unfold <code class="docutils literal notranslate"><span class="pre">pc</span></code>.</p></li>
<li><p>Right-click on the <code class="docutils literal notranslate"><span class="pre">Value</span></code> of <code class="docutils literal notranslate"><span class="pre">pc</span></code> and select “Show Value in Source”.</p></li>
<li><p>Ozone will show the code location from where the failing assertion originated.</p></li>
</ul>
</div>
<div class="section" id="break-on-an-assertion">
<h2><span class="section-number">4.2.1.7. </span>Break on an assertion<a class="headerlink" href="#break-on-an-assertion" title="Permalink to this headline"></a></h2>
<p>It can be helpful to configure Ozone to break when a new assertion location
is written to <code class="docutils literal notranslate"><span class="pre">fas_assertLocation.pc</span></code>.
This can be achieved by setting a data breakpoint on this variable.</p>
<p>The configuration that is supplied with this project automatically adds
<code class="docutils literal notranslate"><span class="pre">fas_assertLocation</span></code> to the watch window and sets a data breakpoint on
<code class="docutils literal notranslate"><span class="pre">fas_assertLocation.line</span></code>.
(It uses <code class="docutils literal notranslate"><span class="pre">.line</span></code> and not <code class="docutils literal notranslate"><span class="pre">.pc</span></code>, because this member is written secondly and
therefore <code class="docutils literal notranslate"><span class="pre">.pc</span></code> is already written when the debugger halts.)
In order to prevent that this breakpoint is triggered during the decompression
of the RAM, the debugger is configured to automatically clear the breakpoint
before a reset and to set it when the probe has detected a completed
initialization phase.</p>
</div>
<div class="section" id="tracing-with-segger-j-trace-pro-cortex">
<h2><span class="section-number">4.2.1.8. </span>Tracing with Segger J-Trace PRO Cortex<a class="headerlink" href="#tracing-with-segger-j-trace-pro-cortex" title="Permalink to this headline"></a></h2>
<p>Apart from debug probes, Segger also supplies trace probes.
With these devices it is possible to stream internal information from the MCU
such as the program counter directly to the debugger.
For the TMS570LC4357 target it is necessary to use the Segger J-Trace PRO
Cortex model.
According to its documentation it is able to trace with a data width of 4 bit.</p>
<p>Information on how to set up the trace probe can be found in the
<a class="reference external" href="https://wiki.segger.com/TI_TMS570Lx#Tracing_on_TI_TMS570LC4357">Segger Wiki</a>.
Please note, that as of now, only tracing with
<a class="reference internal" href="debugger-lauterbach.html#lauterbach-trace32-debugger"><span class="std std-ref">Lauterbach devices</span></a> has been tested by
<a class="reference external" href="https://www.iisb.fraunhofer.de">Fraunhofer IISB</a>.</p>
</div>
</div>
<div class="section" id="j-flash">
<h1><span class="section-number">4.2.2. </span>J-Flash<a class="headerlink" href="#j-flash" title="Permalink to this headline"></a></h1>
<p>Segger supplies with their debug probes also a software called <cite>J-Flash</cite>.
This software allows to download software into a target without a debug
session.</p>
<p>The foxBMS 2 toolchain has a wrapper for J-Flash that allows to use the utility
directly from waf.
This allows the user to call waf with the <code class="docutils literal notranslate"><span class="pre">install_bin</span></code> command in order to
build and directly download in the connected target.
This feature can be used for integrated tests that have to download the
compiled software into a target.
For the user’s convenience, the <code class="docutils literal notranslate"><span class="pre">code</span></code> workspace contains a <code class="docutils literal notranslate"><span class="pre">Flash:Binary</span></code>
build target that allows to call this action directly from the IDE.</p>
</div>


           </div>
          </div>
<a href="https://github.com/foxBMS/foxbms-2">
    <img style="position: absolute; top: 0; right: 0; border: 0;"
        src="../../_static/forkme.png" alt="Fork me on GitHub">
</a>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="debug-application.html" class="btn btn-neutral float-left" title="4. Debugging the Application" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="debugger-lauterbach.html" class="btn btn-neutral float-right" title="4.2.3. Lauterbach Trace32 Debugger" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2010 - 2023, Fraunhofer-Gesellschaft zur Foerderung der angewandten Forschung e.V. All rights reserved. See license section for further information.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>